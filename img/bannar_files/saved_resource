(()=>{"use strict";var e=function(e){return Array.isArray(e.changes)},version="1.0.0",t=function(e){return"complete"===e._tag},n=function(e){return{_tag:"errors",errors:e}},r=function(e){return{_tag:"complete",undo:e}},o=function(){};function u(e,t){return{code:e,meta:t}}var i=function(e,t){try{return e()}catch(e){return t(e)}};function a(e,t){if("function"!=typeof XMLHttpRequest)throw u("no_xhr");var n=new XMLHttpRequest;n.open("GET",e),t&&(n.onload=function(){return t(n)}),n.send()}var l=function(e,t){if(void 0!==l.rulePath)try{var n=void 0===t?"":Object.keys(t).map((function(e){return"&"+e+"="+t[e]})).join(""),r=[["code",e.code],["meta",encodeURIComponent(JSON.stringify(e.meta))],["version",l.version],["_eid",l._eid],["url",l.url]].reduce((function(e,t){var n=t[0],r=t[1];return void 0!==r?e.concat("&"+n+"="+r):e}),"").concat(n);a(l.rulePath+"/e.json?"+r)}catch(e){}},c=function(e){l._eid=e._eid,l.url=e.url,l.version=e.version},s=null,f=function(e){var t=e.split("?"),n=t[0],r=t[1];if(!r)return e;var o=r.split("&").reduce((function(e,t){var n=t.split("="),r=n[0],o=n[1];return e[r]=o,e}),{});delete o.utm_source,delete o.utm_medium,delete o.utm_campaign,delete o.utm_term,delete o.utm_content;var u="";for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(u+=i+"="+o[i]+"&");return(u=u.slice(0,-1))?n+"?"+u:n},d=function(e){return void 0===e&&(e=location),f(e.pathname.replace(/\/+$/,""))},h=function(e){return void 0===e&&(e=location),f(d()+e.search)},p=function(version,e,t){void 0===t&&(t=location);var n=null!=s?s:s=function(e){var t=function(e){for(var t=0;t<e.length;t++){var n=document.querySelector('script[src^="'+e[t]+'"]');if(null!==n)return n}return null}([e,e.replace(/^http(s)?:/,"")]);if(null===t)return null;var n=t.getAttribute("id");return null===n?null:n}(e);if(null===n)return null;var r=d(t),o={full:""+t.host+r,searchParams:f(t.search),path:r},u=[e,"s",n,o.full].join("/");return function(e){l.rulePath=e}(u),{rulePath:u+"/0.json?version="+version,projectId:n,location:o}},v=function(e){return e.map((function(e){return e.content})).join("")};function m(e,t,n,r){if(0===e.length)throw u("empty_css_selector",{context:n,destination:r});var o=i((function(){var t=document.querySelectorAll(e);if(0===t.length)throw new Error;return t}),(function(){throw u("bad_css_selector",{selector:e,context:n,destination:r})})),a=o[t];if(!a)throw u("bad_css_index",{selector:e,index:t,count:o.length,context:n,destination:r});return a}function b(e,t){var n=e.parentElement;if(null===n)throw u("orphan_element",{context:t});return n}function y(e){return b(e,4).removeChild(e),o}function w(e,t){return e.textContent=t(),o}function g(e,t,n){return e.setAttribute(t,n()),o}function _(e,t){return e.removeAttribute(t),o}function x(e,t){var n=b(e,2),r=document.createElement(t);return Array.prototype.slice.call(e.attributes).forEach((function(e){r.setAttribute(e.name,e.value)})),r.innerHTML=e.innerHTML,n.replaceChild(r,e),o}var E,T=function(e,t,n){if(e.contains(t))throw u("element_contains_target",{context:3});return t.insertAdjacentElement(n,e),o},A=function(e,t,n){var r={selector:null,template:null};switch(t.html_tag){case"title":r.selector={query:"title",index:0},r.template="<title></title>";break;case"metaDescription":r.selector={query:'meta[name="description"]',index:0},r.template='<meta name="description" content="">';break;case"relCanonical":r.selector={query:'link[rel="canonical"]',index:0},r.template='<link rel="canonical" href="">'}if(!r.selector||!r.template)return{undo:o,element:e};var u=document.querySelectorAll(r.selector.query)[r.selector.index]||function(e,t,n){var r=document.createElement("div");r.insertAdjacentHTML("afterbegin",t);var o=r.firstElementChild;return e.insertAdjacentElement(n,o),o}(e,r.template,n);switch(t.html_tag){case"title":u.textContent=v(t.template);break;case"metaDescription":u.setAttribute("content",v(t.template));break;case"relCanonical":u.setAttribute("href",v(t.template))}return{undo:o,element:u}},C={after:"afterend",before:"beforebegin",firstChild:"afterbegin",lastChild:"beforeend"},M=function(e){return function(t,n){return e[t._tag](t,n)}}({AddHTML:function(e){return function(e,t,n){var r,u=document.createElement("div");if(u.insertAdjacentHTML("afterbegin",n()),u.childNodes.length>1||(null===(r=u.firstChild)||void 0===r?void 0:r.nodeType)===Node.TEXT_NODE){for(var i=document.createElement("div");u.hasChildNodes();)i.appendChild(u.firstChild);u.appendChild(i)}var a=u.firstElementChild;return e.insertAdjacentElement(t,a),{undo:o,element:a}}(m(e.selector.query,e.selector.index,5),C[e.placement],(function(){return v(e.template)}))},Delete:function(e,t){var n=null!=t?t:m(e.selector.query,e.selector.index,4);return{undo:y(n),element:n}},UpdateContent:function(e,t){var n=null!=t?t:m(e.selector.query,e.selector.index,0);return{undo:w(n,(function(){return v(e.template)})),element:n}},UpdateAttribute:function(e,t){var n=null!=t?t:m(e.selector.query,e.selector.index,1);return{undo:g(n,e.attribute,(function(){return v(e.template)})),element:n}},DeleteAttribute:function(e,t){var n=null!=t?t:m(e.selector.query,e.selector.index,7);return{undo:_(n,e.attribute),element:n}},UpdateType:function(e,t){var n=null!=t?t:m(e.selector.query,e.selector.index,2);return{undo:x(n,e.type),element:n}},Move:function(e,t){var n=null!=t?t:m(e.from.query,e.from.index,3,0);return{undo:T(n,m(e.to.query,e.to.index,3,1),C[e.placement]),element:n}},SetMetaTagContent:function(e){var t=m(e.selector.query,e.selector.index,8);return A(t,e,C[e.placement])}}),P=function(e){return function(t){var n=new Map,r=new Map,o=[],u=-1,a=t.filter((function(t,a){return i((function(){var r=e(t,n.get(t.element_id)),u=r.undo,i=r.element;return o.push(u),n.set(t.element_id,i),!1}),(function(e){return u=-1===u?a:u,r.set(t,e),!0}))}));return[u,a,r,o]}}(M),k=function(e,t){return function(n){var r=n.changes,o=n.changesLength,i=n.variables,a=n.errors,l=n.variableValues,c=n.undoes,s=e(l,i),f=s[0],d=s[1],h=s[2],p=d.length>0?[0,r,a,[]]:t(r,f,a),v=p[0],m=p[1],b=p[2];if(p[3].forEach((function(e){return c.push(e)})),d.length>0){var y=h.values().next().value;m.forEach((function(e){return b.set(e,y)}))}else m.slice(1).forEach((function(e){return b.set(e,u("error_in_previous_rule",{index:o-m.length+v+1}))}));return{changes:m,changesLength:o,variables:d,variableValues:f,errors:b,undoes:c}}}((function(){return[new Map,[],new Map]}),P),O=function(e){return function(t){var u,i,a=t.changes,c=t.variables,s=t.timeout,f=t.onRulesLeft,d=t.logErrorsThreshold,p=t.onSetCurrentUndo,v={changes:a,changesLength:a.length,variables:c,variableValues:new Map,errors:new Map,undoes:[]},m=null,b=h(),y=function(){null==m||m.disconnect(),clearTimeout(u),clearTimeout(i)};return new Promise((function(t){var a=function(e,t){var n,r,o=!1;return function u(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(o)return n=i,void(r=this);e.apply(this,i),o=!0,setTimeout((function(){o=!1,n&&(u.apply(r,n),n=r=void 0)}),t)}}((function(){if(h()!==b)return y(),v.errors.size>0?n(v.errors):r(o);v=e(v);var u,i=(u=v.undoes,function(){u.reverse().forEach((function(e){return e()})),u.splice(0,Number.MAX_SAFE_INTEGER)});return null==f||f(v.changes),null==p||p(i),0===v.changes.length?t(r(i)):!(v.changes.length>0)&&(v.errors.size>0?t(n(v.errors)):void 0)}),15);a(),(m=new MutationObserver(a)).observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0}),u=setTimeout((function(){return t(n(v.errors))}),s),i=setTimeout((function(){return v.errors.size>0&&l(v.errors.values().next().value)}),d)})).then((function(e){return y(),e}))}}(k),S=function(e,t,n,r){return new(n||(n=Promise))((function(o,u){function i(e){try{l(r.next(e))}catch(e){u(e)}}function a(e){try{l(r.throw(e))}catch(e){u(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},j=function(e,t){var n,r,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function a(u){return function(a){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,a])}}},q=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},L=function(e,t,n,r){return new(n||(n=Promise))((function(o,u){function i(e){try{l(r.next(e))}catch(e){u(e)}}function a(e){try{l(r.throw(e))}catch(e){u(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},N=function(e,t){var n,r,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function a(u){return function(a){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,a])}}},I=function(e,t,version,n){var r=p(version,n);null!==r&&a(r.rulePath,(function(n){return L(void 0,void 0,void 0,(function(){var o;return N(this,(function(a){switch(a.label){case 0:return o=function(){return function(e,t,n,r,o){return S(void 0,void 0,void 0,(function(){var a,s,f,d,h,p;return j(this,(function(v){switch(v.label){case 0:if(a=function(e){return r(e)},200!==e.status)return[2,!1];if(s=i((function(){return JSON.parse(e.responseText)}),(function(){throw u("not_json")})),f=s._eid,d=s.url,!(h=q(s,["_eid","url"]))||!a(h))return[3,3];if(c({_eid:f,url:d}),0!==n.length||void 0!==d&&d!==t&&d!==t.replace(/^http(s)?:\/\//,""))throw u("url_mismatch");return[4,(m=0,new Promise((function(e){return setTimeout(e,m)})))];case 1:return v.sent(),(p=5e3-Date.now()+window.performance.timing.domContentLoadedEventEnd)<0&&l(u("bot_left_before_applying")),[4,o(h,p)];case 2:return[2,v.sent()];case 3:return[2,!1]}var m}))}))}(n,r.location.full,r.location.searchParams,t,e).catch(l)},"loading"!==document.readyState?[3,1]:(window.addEventListener("DOMContentLoaded",o),[3,3]);case 1:return[4,o()];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}))},D=function(e,t,n,r){return new(n||(n=Promise))((function(o,u){function i(e){try{l(r.next(e))}catch(e){u(e)}}function a(e){try{l(r.throw(e))}catch(e){u(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},H=function(e,t){var n,r,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function a(u){return function(a){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,r=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,a])}}};c({version}),E=function(){return I((function(e,n){var r=e.changes;return D(void 0,void 0,void 0,(function(){var e;return H(this,(function(o){switch(o.label){case 0:return[4,O({changes:r,variables:[],timeout:6e4,logErrorsThreshold:n})];case 1:return e=o.sent(),[2,t(e)]}}))}))}),e,version,"https://pageimprove.io")},!0!==window.__PAGEIMPROVE_DISABLE_SCRIPT_IMPLEMENTATION__&&E()})();